!function(){"use strict";var e="undefined"==typeof global?self:global;if("function"!=typeof e.require){var t={},r={},n={},i={}.hasOwnProperty,a=/^\.\.?(\/|$)/,o=function(e,t){for(var r,n=[],i=(a.test(t)?e+"/"+t:t).split("/"),o=0,s=i.length;o<s;o++)r=i[o],".."===r?n.pop():"."!==r&&""!==r&&n.push(r);return n.join("/")},s=function(e){return e.split("/").slice(0,-1).join("/")},u=function(t){return function(r){var n=o(s(t),r);return e.require(n,t)}},l=function(e,t){var n=v&&v.createHot(e),i={id:e,exports:{},hot:n};return r[e]=i,t(i.exports,u(e),i),i.exports},c=function(e){var t=n[e];return t&&e!==t?c(t):e},_=function(e,t){return c(o(s(e),t))},d=function(e,n){null==n&&(n="/");var a=c(e);if(i.call(r,a))return r[a].exports;if(i.call(t,a))return l(a,t[a]);throw new Error("Cannot find module '"+e+"' from '"+n+"'")};d.alias=function(e,t){n[t]=e};var f=/\.[^.\/]+$/,h=/\/index(\.[^\/]+)?$/,p=function(e){if(f.test(e)){var t=e.replace(f,"");i.call(n,t)&&n[t].replace(f,"")!==t+"/index"||(n[t]=e)}if(h.test(e)){var r=e.replace(h,"");i.call(n,r)||(n[r]=e)}};d.register=d.define=function(e,n){if(e&&"object"==typeof e)for(var a in e)i.call(e,a)&&d.register(a,e[a]);else t[e]=n,delete r[e],p(e)},d.list=function(){var e=[];for(var r in t)i.call(t,r)&&e.push(r);return e};var v=e._hmr&&new e._hmr(_,d,t,r);d._cache=r,d.hmr=v&&v.wrap,d.brunch=!0,e.require=d}}(),function(){"undefined"==typeof window?this:window;require.register("src/BaseApplication.js",function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(){n(this,e)}return i(e,[{key:"start",value:function(){}},{key:"end",value:function(){}},{key:"update",value:function(){}},{key:"on_post_render",value:function(){}},{key:"on_pre_render",value:function(){}}]),e}();e["default"]=a}),require.register("src/CameraManager.js",function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(){n(this,e),this._current=void 0}return i(e,[{key:"current",set:function(e){this._current=e},get:function(){return this._current}}]),e}(),o=new a;r.exports=o}),require.register("src/Capabilities.js",function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function o(){n(this,o),this.max_anisotropy=0,this.vertex_texture_sampler_available=!1,this.fp_textures_available=!1},a=new i;r.exports=a}),require.register("src/Configuration.js",function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(){arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n(this,e),this.dpr=window.devicePixelRatio?window.devicePixelRatio:1,this.is_mobile=!1,this.is_ios=!1,this.vertex_image_unit_supported=!0,this.min_zoom_distance=3e3,this.max_zoom_distance=4e4,this.max_zoom_distance_scale=1.1,this.zoom_speed=.1,this.use_fxaa=!1,this.use_ssaa=!0,this.background_color=new THREE.Color(.768,.768,.768),this.touch_sensitivity=1.5,this.zoom_sensitivity=.7,this.spin_sensitivity=2,this.three_finger_rotation_speed=3,this.three_finger_allowed_x_rotation_offset=30,this.three_finger_allowed_y_rotation_offset=20,this.use_touch_gestures=!1,this.texture_float_supported=!1,this.use_ortographic=!0,this.hover_enabled=!1,this.rotation_enabled=!1,this.transparency_amount=.2,this.show_debug_sphere_on_floor_selection=!1,this.show_debug_sphere_on_steps_in_floor=!1,this.display_cleanup_log=!1,this.navigation_speed_damping=.74,this.navigation_speed=200,this.out_of_bounds_force=1.5,this.mouse_zoom_speed=.05,this.touch_zoom_speed=.5}return i(e,[{key:"from_json",value:function(e){}}]),e}(),o=new a;r.exports=o}),require.register("src/Debug.js",function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=t("./components/AxisHelper"),s=n(o),u=t("./shaders/basic_color/basic_color_vert"),l=n(u),c=t("./shaders/basic_color/basic_color_frag"),_=n(c),d=t("./SceneManager"),f=n(d),h=t("./Graphics"),p=(n(h),t("./primitives/Cube")),v=n(p),m=t("./primitives/Sphere"),y=n(m),g=function(){function e(){i(this,e),this.Vector3_one=new THREE.Vector3(1,1,1),this.Vector3_zero=new THREE.Vector3(0,0,0),this.canvas_renderer=void 0,this.rt_debug=void 0}return a(e,[{key:"init",value:function(e){this.webgl=e,this.ctx=void 0}},{key:"draw_axis",value:function(){var e=new s["default"];return f["default"].current.add(e),e}},{key:"set_debug_RT",value:function(e){this.rt_debug=e}},{key:"draw_rectangle",value:function(e,t,r,n){t=t||100,r=r||100,this.ctx.fillStyle=n||"rgba(255, 0, 0, 1)",this.ctx.fillRect(e.x-t/2,this.ctx.canvas.height-e.y-r/2,t,r)}},{key:"clear",value:function(){this.ctx&&this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}},{key:"draw_line_2D",value:function(e,t,r){this.ctx.strokeStyle=r||"rgba(255, 0, 0, 1)",this.ctx.beginPath(),this.ctx.moveTo(e.x,e.y),this.ctx.lineTo(t.x,t.y),this.ctx.closePath(),this.ctx.stroke()}},{key:"draw_line",value:function(e,t,r){r=r||16711680;var n=new THREE.LineBasicMaterial({color:r}),i=new THREE.Geometry;i.vertices.push(e),i.vertices.push(t);var a=new THREE.Line(i,n);return f["default"].current.add(a),a}},{key:"draw_cube",value:function(e,t,r){t=t||1,r=r||16711680,e=e||new THREE.Vector3;var n=new v["default"](new THREE.Vector3(t,t,t),(void 0),r);return n.position.copy(e),f["default"].current.add(n),n}},{key:"draw_oriented_cube",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"#FF0000",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,a=e.distanceTo(t),o=new v["default"](new THREE.Vector3(i,r,a),(void 0),n),s=t.clone().sub(e).multiplyScalar(.5),u=s.clone().normalize();s.add(e),o.position.copy(s);var l=new THREE.Vector3(0,1,0),c=u.clone();c.clone().cross(l);return o.quaternion.setFromUnitVectors(new THREE.Vector3(0,0,(-1)),u),f["default"].current.add(o),o}},{key:"draw_plane",value:function(e,t,r){var n=new THREE.PlaneGeometry(e,t),i=new THREE.ShaderMaterial({uniforms:{_Color:{value:new THREE.Vector4(0,1,0,.2)}},vertexShader:l["default"],fragmentShader:_["default"],transparent:!0,depthWrite:!1}),a=new THREE.Mesh(n,i);return a.renderOrder=-1e4,f["default"].current.add(a),a}},{key:"draw_empty_cube",value:function(e,t,r){t=t||1,r=r||16711680;var n=(new THREE.Box3).setFromCenterAndSize(new THREE.Vector3,new THREE.Vector3(t,t,t)),i=new THREE.Box3Helper(n,r);return i.position.copy(e||new THREE.Vector3),i}},{key:"draw_sphere",value:function(e,t,r){t=t||1,r=r||16711680,e=e||new THREE.Vector3;var n=new y["default"](t,r);return n.position.copy(e),f["default"].current.add(n),n}},{key:"draw_sphere_helper",value:function(e,t){t=t||16711680;var r=new THREE.SphereGeometry(e.radius,32,32),n=new THREE.MeshBasicMaterial({color:t,side:THREE.DoubleSide}),e=new THREE.Mesh(r,n);f["default"].current.add(e)}},{key:"draw_math_sphere",value:function(e){var t=new THREE.SphereGeometry(e.radius,32,32),r=new THREE.ShaderMaterial({uniforms:{_Color:{value:new THREE.Vector4(1,0,0,.2)}},vertexShader:l["default"],fragmentShader:_["default"],transparent:!0}),n=new THREE.Mesh(t,r);n.position.copy(e.center),f["default"].current.add(n)}},{key:"draw_bounding_box",value:function(e){var t=new THREE.Box3Helper(e,16776960);f["default"].current.add(t)}},{key:"draw_curve",value:function(e,t){var r=new THREE.Vector3(0,0,0);t&&(r.y=t.offset||0);for(var n=0;n<e.length-1;n++)this.draw_line(e[n].clone().add(r),e[n+1].clone().add(r))}}]),e}(),b=new g;r.exports=b}),require.register("src/EventManager.js",function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(){n(this,e),this.queue={},this.zoom_changed_evt="zoom_changed",this.store_clickd_evt="store_clicked",this.point_selected_evt="point_selected",this.config_changed="config_changed",this.path_substep_completed="path_substep_completed",this.path_completed="path_completed",this.go_to_store_requested_evt="go_to_store_requested",this.resource_loaded_evt="resource_loaded",this.service_clicked_evt="service_clicked",this.unit_pos_updated_evt="unit_position_updated",this.floor_changed_evt="floor_changed",this.on_enter_floor_navigation="on_enter_floor_navigation",this.on_exit_floor_navigation="on_exit_floor_navigation",this.on_enter_floor_selection="on_enter_floor_selection",this.on_exit_floor_selection="on_exit_floor_selection",this.on_enter_outside_navigation="on_enter_outside_navigation",this.on_exit_outside_navigation="on_exit_outside_navigation",this.step_selected_evt="step_selected"}return i(e,[{key:"fire",value:function(e,t){var r=this.queue[e];if(void 0!==r)for(var n=r.length;n--;)r[n](t)}},{key:"on",value:function(e,t){"undefined"==typeof this.queue[e]&&(this.queue[e]=[]),this.queue[e].push(t)}},{key:"fire_zoom_changed",value:function(e){this.fire(this.zoom_changed_evt,e)}},{key:"fire_store_selected",value:function(e){this.fire(this.store_clickd_evt,e)}},{key:"fire_point_selected",value:function(e){this.fire(this.point_selected_evt,e)}},{key:"fire_config_changed",value:function(){this.fire(this.config_changed)}},{key:"fire_path_substep_completed",value:function(e){this.fire(this.path_substep_completed,e)}},{key:"fire_path_completed",value:function(){this.fire(this.path_completed)}},{key:"fire_step_selected",value:function(e){this.fire(this.step_selected_evt,e)}},{key:"fire_go_to_store_requested",value:function(e){this.fire(this.go_to_store_requested_evt,e)}},{key:"fire_resource_loaded",value:function(e){this.fire(this.resource_loaded_evt,e)}},{key:"fire_service_clicked",value:function(e){this.fire(this.service_clicked_evt,e)}},{key:"fire_unit_position_updated",value:function(e){this.fire(this.unit_pos_updated_evt,e)}},{key:"fire_floor_switched",value:function(e){this.fire(this.floor_changed_evt,e)}},{key:"fire_on_enter_floor_navigation",value:function(e){this.fire(this.on_enter_floor_navigation,e)}},{key:"fire_on_exit_floor_navigation",value:function(e){this.fire(this.on_exit_floor_navigation,e)}},{key:"fire_on_enter_floor_selection",value:function(e){this.fire(this.on_enter_floor_selection,e)}},{key:"fire_on_exit_floor_selection",value:function(e){this.fire(this.on_exit_floor_selection,e)}},{key:"fire_on_enter_outside_navigation",value:function(e){this.fire(this.on_enter_outside_navigation,e)}},{key:"fire_on_exit_outside_navigation",value:function(e){this.fire(this.on_exit_outside_navigation,e)}}]),e}(),o=new a;r.exports=o}),require.register("src/Graphics.js",function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=t("./Configuration"),u=n(s),l=t("./render_mode/BaseRender"),c=n(l),_=t("./render_mode/OutlineRender"),d=(n(_),t("./Screen")),f=n(d),h=t("./CameraManager"),p=n(h),v=t("./SceneManager"),m=n(v),y=t("./UI"),g=n(y),b=t("./Capabilities"),w=n(b),x=t("./render_utilities/DepthAndNormalsRenderer"),E=n(x),k=t("./render_utilities/Blitter"),T=n(k),R=function(){function e(){i(this,e),this._renderer=void 0,this.blitter=void 0,this.dom=void 0,this.no_render=void 0,this.current_render_mode=void 0,this.generateDepthNormalTexture=!1,this.depth_and_normals_renderer=void 0}return o(e,[{key:"init",value:function(e){this._renderer=new THREE.WebGLRenderer({antialias:!1,preserveDrawingBuffer:!0,alpha:!0,canvas:e}),this._renderer.autoClear=!1,u["default"].is_mobile?this._renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)):this._renderer.setPixelRatio(Math.min(Math.max(window.devicePixelRatio,1.5),2)),this._renderer.extensions.get("ANGLE_instanced_arrays"),this.blitter=new T["default"](this._renderer),this.dom=this._renderer.domElement,this.no_render=new c["default"],this.current_render_mode=this.no_render,w["default"].max_anisotropy=this._renderer.capabilities.getMaxAnisotropy(),w["default"].vertex_texture_sampler_available=this._renderer.capabilities.maxVertexTextures>0,w["default"].fp_textures_available=this._renderer.capabilities.floatVertexTextures,this.generateDepthNormalTexture=!1,this.depth_and_normals_renderer=new E["default"]}},{key:"append_canvas",value:function(e){this.dom.id=e.id+"-canvas",this.container=e,this.on_resize()}},{key:"set_state",value:function(e){console.log("VIEWAPI - map render mode switch to: "+e.constructor.name),this.current_render_mode.on_exit(this,this._renderer),this.current_render_mode=e,this.current_render_mode.on_enter(this,this._renderer)}},{key:"update",value:function(){this.generateDepthNormalTexture&&this.depth_and_normals_renderer.render(this),p["default"].current&&(p["default"].current.aspect=f["default"].aspect_ratio,p["default"].current.updateProjectionMatrix(),p["default"].current.updateMatrix(),p["default"].current.updateMatrixWorld(!0),this.current_render_mode.render())}},{key:"render",value:function(e,t,r,n){this.__apply_override_material(e,n),this._renderer.setRenderTarget(void 0===r?null:r),this._renderer.render(e||m["default"].current,t||p["default"].current),this.__apply_override_material(e,void 0)}},{key:"__apply_override_material",value:function(e,t){e?e.overrideMaterial=t:m["default"].current.overrideMaterial=t}},{key:"readback_RT",value:function(e,t){this._renderer.readRenderTargetPixels(e,0,0,e.width,e.height,t)}},{key:"clear",value:function(e,t,r,n){this._renderer.setRenderTarget(void 0===e?null:e),t&&this._renderer.setClearColor(t.clear_color,t.clear_alpha),this._renderer.clear(!!t,!!r,!!n)}},{key:"render_ui",value:function(e){this._renderer.render(e,p["default"].current)}},{key:"on_resize",value:function(){var e=this.container.offsetWidth,t=this.container.offsetHeight;f["default"].update_size(e,t),f["default"].update_native_size(),this._renderer.setSize(e,t,!1),g["default"].resize(),this.current_render_mode.resize(e,t)}},{key:"blit",value:function(e,t,r){r?this.blitter.blit_with_material(e,t,r):this.blitter.blit(e,t)}},{key:"blit_clear_with_material",value:function(e,t){this.blitter.blit_clear_with_material(e,t)}},{key:"take_screenshot",value:function(e){var t=f["default"].width,r=f["default"].height,n=4096,i=4096,a=1024,o=1024,s=parseInt(Math.ceil(n/a)),u=parseInt(Math.ceil(i/o));f["default"].update_size(a,o),this._renderer.setPixelRatio(1),this._renderer.setSize(a,o,!1),this.ctx_2D.canvas.width=n,this.ctx_2D.canvas.height=i,p["default"].current.aspect=f["default"].aspect_ratio,p["default"].current.updateMatrix(),p["default"].current.updateMatrixWorld(!0);for(var l=0;l<s;l++)for(var c=0;c<u;c++)p["default"].current.setViewOffset(n,i,f["default"].width*l,f["default"].height*c,f["default"].width,f["default"].height),this.current_render_mode.render(),this.ctx_2D.drawImage(this._renderer.domElement,f["default"].width*l,f["default"].height*c);this.ctx_2D.canvas.toBlob(e,"image/png;base64;"),p["default"].current.clearViewOffset(),f["default"].update_size(t,r),this._renderer.setPixelRatio(window.devicePixelRatio),this._renderer.setSize(t,r,!1),p["default"].current.aspect=f["default"].aspect_ratio,p["default"].current.updateMatrix(),p["default"].current.updateMatrixWorld(!0)}},{key:"download_screenshot",value:function(e){console.log("el blob",e);var t=document.createElement("a");t.download="Snapshot.png",t.href=URL.createObjectURL(e),t.click(),t.onclick=function(){requestAnimationFrame(function(){URL.revokeObjectURL(a.href)}),a.removeAttribute("href")}}},{key:"dom_element",get:function(){return this._renderer.domElement}},{key:"depth_normals_RT",get:function(){return this.depth_and_normals_renderer.render_target}}]),e}(),M=new R;r.exports=M}),require.register("src/Input.js",function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=t("./Screen"),s=n(o),u=t("./Configuration"),l=(n(u),t("./Time")),c=n(l),_=t("./KeyboardInput"),d=n(_),f=function(){function e(){i(this,e),this.mouse_pos=new THREE.Vector2,this.last_mouse_pos=new THREE.Vector2,this.mouse_dir=new THREE.Vector2,this.__clicked_time=0,this.__elapsed_time=0,this.__delta_time=0,this.is_mouse_down=!1,this.is_mouse_up=!1,this.rotation_angle=0,this._normalized_mouse_pos=new THREE.Vector2(0,0),this.left_mouse_button_down=!1,this.left_mouse_button_pressed=!1,this.left_mouse_button_released=!1,this.middle_mouse_button_down=!1,this.right_mouse_button_down=!1,this.right_mouse_button_pressed=!1,this.right_mouse_button_released=!1,this.mousewheel=0,this.previous_scale=0,this.previous_rotation=0,this.previous_rotation_dirty=!0,this.mouse_str="mouse",this.tmp_mouse_velocity=new THREE.Vector2,this.bounding_client=new THREE.Vector2,this.multitouch_active=!1,this.tapped=!1,this.initial_zoom_distance=100,this.zoom_center=new THREE.Vector2,this.zoom_started=!1,this.touch_zoom=1,this.multi_touch_dir=new THREE.Vector2,this.wheel_delta=0}return a(e,[{key:"init",value:function(e){var t=this,r=new ZingTouch.Region(e,(!1),(!0));d["default"].init();var n=this;r.bind(e,"tap",function(e){n.tapped=!0,n.set_mouse_pos(e)});var i=new ZingTouch.Pan({numInputs:1});r.register("one_finger_pan",i),r.bind(e,"one_finger_pan",function(e){e.detail.data.length>0&&n.on_mouse_move(e)});var a=new ZingTouch.Pan({numInputs:2});r.register("two_fingers_pan",a),r.bind(e,"two_fingers_pan",function(e){e.detail.data.length>0&&(n.multi_touch_dir.set(e.detail.data[0].change.x,e.detail.data[0].change.y),n.multi_touch_dir.multiplyScalar(n.__delta_time))});var o=new ZingTouch.Pan({numInputs:3});r.register("three_fingers_pan",o),r.bind(e,"three_fingers_pan",function(e){e.detail.data.length>0&&(n.multi_touch_dir.set(e.detail.data[0].change.x,e.detail.data[0].change.y),n.multi_touch_dir.multiplyScalar(n.__delta_time))}),r.bind(e,"distance",function(e){n.zoom_started||(n.zoom_started=!0,n.initial_zoom_distance=e.detail.distance,n.zoom_center.set(e.detail.center.x,e.detail.center.y),n.mouse_pos.set(e.detail.center.x,e.detail.center.y)),n.touch_zoom=THREE.Math.clamp(e.detail.distance/n.initial_zoom_distance,0,2)});var s=new ZingTouch.Gesture;s.end=function(e,t,r){n.on_mouse_up(e)},s.start=function(e,t,r){n.on_mouse_down(e)},r.register("shortTap",s),r.bind(e,"shortTap",function(e){}),$(e).mousewheel(this.on_mouse_wheel.bind(this)),e.addEventListener("contextmenu",function(e){e.preventDefault()},!1),e.addEventListener("mousemove",function(e){t.mouse_pos.x=e.offsetX,t.mouse_pos.y=e.offsetY})}},{key:"set_mouse_pos",value:function(e){this.mouse_pos.x=e.detail.events[0].clientX,this.mouse_pos.y=e.detail.events[0].clientY}},{key:"on_mouse_wheel",value:function(e){e.preventDefault(),Math.abs(e.deltaY)>.1?this.wheel_delta=e.deltaY/Math.abs(e.deltaY):this.wheel_delta=0,e.ctrlKey&&(this.wheel_delta*=1),this.mouse_pos.x=e.clientX,this.mouse_pos.y=e.clientY}},{key:"on_mouse_down",value:function(e){switch(e[0].current.originalEvent.preventDefault(),this.mouse_pos.x=e[0].current.clientX,this.mouse_pos.y=e[0].current.clientY,this.multitouch_active=e.length>1,this.mouse_dir.x=0,this.mouse_dir.y=0,this.__clicked_time=this.__elapsed_time,this.is_mouse_down=!0,this.is_mouse_up=!1,e[0].current.originalEvent.which){case 1:this.left_mouse_button_down=!0,this.left_mouse_button_pressed=!0;break;case 2:this.middle_mouse_button_down=!0;break;case 3:this.right_mouse_button_down=!0,this.right_mouse_button_pressed=!0;break;default:this.left_mouse_button_down=!0,this.left_mouse_button_pressed=!0}this.wheel_delta=0,this.previous_scale=0,this.previous_rotation=0}},{key:"mouse_clicked",value:function(){return this.tapped}},{key:"on_mouse_up",value:function(e){e[0].current.originalEvent.preventDefault(),this.left_mouse_button_released=!0,this.right_mouse_button_released=!0,this.multitouch_active=e.length>1,this.is_mouse_up=!0,this.zoom_started=!1,this.touch_zoom=1,this.mouse_dir.x=0,this.mouse_dir.y=0,this.previous_scale=0,this.previous_rotation=0,this.wheel_delta=0,this.left_mouse_button_down=!1,this.middle_mouse_button_down=!1,this.right_mouse_button_down=!1,this.is_mouse_down=!1,this.previous_rotation_dirty=!0,this.rotation_delta=0}},{key:"time_since_last_mouse_down",value:function(){return this.__elapsed_time-this.__clicked_time}},{key:"on_mouse_move",value:function(e){e.preventDefault(),e.detail.data.length>0&&(this.set_mouse_pos(e),this.mouse_dir.set(e.detail.data[0].change.x,e.detail.data[0].change.y),this.mouse_dir.multiplyScalar(this.__delta_time/window.devicePixelRatio))}},{key:"clear",value:function(){this.__elapsed_time=c["default"].elapsed_time,this.__delta_time=c["default"].delta_time,this.is_mouse_up=!1,this.wheel_delta=0,this.rotation_delta=0,this.tapped=!1,this.mouse_dir.multiplyScalar(0),this.multi_touch_dir.multiplyScalar(0),this.left_mouse_button_pressed=!1,this.left_mouse_button_released=!1,this.right_mouse_button_pressed=!1,this.right_mouse_button_released=!1,d["default"].clear()}},{key:"normalized_mouse_pos",get:function(){return this._normalized_mouse_pos.x=this.mouse_pos.x/s["default"].width*2-1,this._normalized_mouse_pos.y=-1*(this.mouse_pos.y/s["default"].height*2-1),this._normalized_mouse_pos}},{key:"NDC",get:function(){return this.normalized_mouse_pos}}]),e}(),h=new f;r.exports=h}),require.register("src/KeyboardInput.js",function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e.KeyboardInput=function(){function e(){n(this,e),this.ctrlz_pressed=!1,this.ctrlz_fired=!1,this.keys=[]}return i(e,[{key:"init",value:function(){document.onkeydown=this.on_key_down.bind(this),document.onkeyup=this.on_key_up.bind(this),document.onkeypress=this.on_key_press.bind(this)}},{key:"on_key_down",value:function(e){90==e.keyCode&&e.ctrlKey&&!this.ctrlz_fired&&(this.ctrlz_pressed=!0,this.ctrlz_fired=!0),e.key&&this.press_key(e.key)}},{key:"on_key_press",value:function(e){}},{key:"on_key_up",value:function(e){this.release_keys()}},{key:"clear",value:function(){this.ctrlz_pressed=!1;for(var e=0;e<this.keys.length;e++)this.keys[e].pressed=!1}},{key:"release_keys",value:function(){this.ctrlz_fired=!1;for(var e=0;e<this.keys.length;e++)this.keys[e].fired=!1,this.keys[e].down=!1}},{key:"press_key",value:function(e){for(var t=0;t<this.keys.length;t++)this.keys[t].key_name!==e||this.keys[t].fired||(this.keys[t].pressed=!0,this.keys[t].down=!0,this.keys[t].fired=!0)}},{key:"key_is_pressed",value:function(e){for(var t=0;t<this.keys.length;t++)if(this.keys[t].key_name===e)return this.keys[t].pressed;return!1}},{key:"key_is_down",value:function(e){for(var t=0;t<this.keys.length;t++)if(this.keys[t].key_name===e)return this.keys[t].down;return!1}},{key:"register_key",value:function(e){this.keys.push({key_name:e,pressed:!1,down:!1,up:!1,fired:!1})}},{key:"unregister_key",value:function(e){for(var t=void 0,r=0;r<this.keys.length;r++)this.keys[r].key_name===e&&(t=this.keys[r]);var n=this.keys.indexOf(t);n>-1&&this.keys.splice(n,1)}}]),e}(),o=new a;r.exports=o}),require.register("src/Mesh.js",function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=t("./editor/shaders/object_picker_vert"),l=n(u),c=t("./editor/shaders/object_picker_frag"),_=n(c),d=function(e){function t(e,r){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return n._selectable_material=n.__get_selectable_material(),n.original_material=n.material,n.stored_layers=n.layers.mask,n}return o(t,e),s(t,[{key:"__get_selectable_material",value:function(){return new THREE.ShaderMaterial({uniforms:{_Color:{value:new THREE.Color}},vertexShader:l["default"],fragmentShader:_["default"]})}},{key:"restore_material",value:function(){this.material=this.original_material}},{key:"store_layer_state",value:function(){this.stored_layers=this.layers.mask}},{key:"restore_layer_state",value:function(){this.layers.mask=this.stored_layers}},{key:"selectable_material",get:function(){return this._selectable_material}}]),t}(THREE.Mesh);e["default"]=d}),require.register("src/RenderLayers.js",function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(){n(this,e)}return i(e,null,[{key:"opaque",get:function(){return 0}},{key:"transparent",get:function(){return 1}},{key:"outline",get:function(){return 2}},{key:"selectable",get:function(){return 3}}]),e}();e["default"]=a}),require.register("src/RenderLoop.js",function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=t("./Time"),s=n(o),u=t("./Input"),l=n(u),c=t("./UI"),_=n(c),d=t("./Debug"),f=n(d),h=t("./static_batcher/GeometryBatcher"),p=(n(h),t("./BaseApplication")),v=n(p),m=function(){function e(t,r){i(this,e),t=t||new v["default"],this._frame_id=-1,this.target_application=t,this.renderer=r,this.is_running=!0}return a(e,[{key:"update",value:function(){this.is_running&&(s["default"].__update(),f["default"].clear(),this.target_application.update(),this.target_application.on_pre_render(),this.renderer.update(),_["default"].update(),_["default"].render(this.renderer),this.target_application.on_post_render(),f["default"].rt_debug&&this.renderer.blit(f["default"].rt_debug),l["default"].clear(),_["default"].clear(),this._frame_id=requestAnimationFrame(this.update.bind(this)))}},{key:"start",value:function(){this.target_application.start(),this.update(),this.is_running=!0}},{key:"stop",value:function(){this.is_running=!1,this.target_application.end(),cancelAnimationFrame(this._frame_id)}}]),e}();e["default"]=m}),require.register("src/ResourceContainer.js",function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=t("./EventManager"),s=n(o),u=function(){function e(){i(this,e),this.resources={}}return a(e,[{key:"set_resource",value:function(e,t){this.resources[e]=t,s["default"].fire_resource_loaded({name:e,value:t})}},{key:"get_resource",value:function(e){return this.resources[e]}}]),e}(),l=new u;r.exports=l}),require.register("src/SceneManager.js",function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(){n(this,e),this._current=new THREE.Scene,this._current.name="default_scene"}return i(e,[{key:"add_scene",value:function(e){}},{key:"current",get:function(){return this._current},set:function(e){this._current=e}}]),e}(),o=new a;r.exports=o}),require.register("src/Screen.js",function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(){n(this,e),this.width=1,this.height=1,this.width_height=new THREE.Vector2(this.width,this.height),this.screen_materials=[],this.native_width=this.width,this.native_height=this.height,this.pixel_size=new THREE.Vector2(1/this.width,1/this.height)}return i(e,[{key:"update_size",value:function(e,t){this.width=e,this.height=t,this.pixel_size=new THREE.Vector2(1/this.width,1/this.height),this.width_height.x=e,this.width_height.y=t;for(var r=this.screen_materials.length;r--;)this.screen_materials[r].uniforms._ScreenSize.value=this.width_height}},{key:"apply_pixel_density_v2",value:function(e){return e.multiplyScalar(1/window.devicePixelRatio),e}},{key:"apply_pixel_density",value:function(e){return e*(1/window.devicePixelRatio)}},{key:"update_native_size",value:function(){this.native_width=window.innerWidth,this.native_height=window.innerHeight}},{key:"add_screen_material",value:function(e){this.screen_materials.push(e),
e.uniforms._ScreenSize.value=this.width_height}},{key:"remove_screen_material",value:function(e){var t=this.screen_materials.indexOf(e);t>-1&&this.screen_materials.splice(t,1)}},{key:"get_pixel_size",value:function(){return this.pixel_size}},{key:"aspect_ratio",get:function(){return this.width/this.height}}]),e}(),o=new a;r.exports=o}),require.register("src/Time.js",function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(){n(this,e),this.___time=new THREE.Clock,this.__delta_time=0,this.__elapsed_time=0,this.__allocated_time=new THREE.Vector2(0,0)}return i(e,[{key:"__update",value:function(){this.__delta_time=this.___time.getDelta(),this.__elapsed_time=this.___time.getElapsedTime()}},{key:"delta_time",get:function(){return this.__delta_time<.4?this.__delta_time:.016}},{key:"elapsed_time",get:function(){return this.__elapsed_time}},{key:"shader_time",get:function(){return this.__allocated_time.x=this.delta_time,this.__allocated_time.y=this.elapsed_time,this.__allocated_time}}]),e}(),o=new a;r.exports=o}),require.register("src/UI.js",function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=t("./Input"),s=n(o),u=function(){function e(){i(this,e),this.ui_elements=[],this._tmp_normalized_pos=new THREE.Vector2,this.scene=new THREE.Scene,this.scene.autoUpdate=!1,this.scene.frustumCulled=!1}return a(e,[{key:"add_clickable_element",value:function(e){this.ui_elements.push(e),this.scene.add(e.mesh)}},{key:"remove_clickable_element",value:function(e){var t=this.ui_elements.indexOf(e);t>-1&&this.ui_elements.splice(t,1),this.scene.remove(e.mesh)}},{key:"update",value:function(){this._tmp_normalized_pos.copy(s["default"].normalized_mouse_pos);for(var e=0;e<this.ui_elements.length;e++)this.ui_elements[e].update(this._tmp_normalized_pos)}},{key:"render",value:function(e){e.render_ui(this.scene)}},{key:"clear",value:function(){this.current_clicked_element=void 0}},{key:"resize",value:function(){for(var e=0;e<this.ui_elements.length;e++)this.ui_elements[e].resize()}}]),e}(),l=new u;r.exports=l}),require.register("src/api.js",function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var i=t("./Graphics"),a=n(i),o=t("./RenderLoop"),s=(n(o),t("./Configuration")),u=n(s),l=t("./EventManager"),c=n(l),_=t("./Debug"),d=n(_),f=t("./Input"),h=(n(f),t("./CameraManager")),p=n(h),v=t("./SceneManager"),m=n(v),y=t("./utilities/ModelUtilities"),g=n(y),b=t("./ResourceContainer"),w=n(b);r.exports=function(e){function t(){return{scene:m["default"].current,camera:p["default"].current,model_utilities:g["default"],take_screenshot:function(){a["default"].take_screenshot(a["default"].download_screenshot)},register_event:function(e,t){c["default"].on(e,t)},config:u["default"],draw_debug_axis:function(){d["default"].draw_axis()},update:function(e){application.update_texture(e)},set_resource:function(e,t){w["default"].set_resource(e,t)},resize_canvas:function(){a["default"].on_resize()},start:function(){render_loop.start()},dispose:function(){render_loop.stop(),a["default"]._renderer.dispose(),map.dispose()},resource_loading_completed:function(){application.resources_fully_loaded()},version:"0.0.0"}}return r.exports=t,t()}}),require.register("src/components/AxisHelper.js",function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;n(this,t);var r=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this)),a=new THREE.LineBasicMaterial({color:4474111,depthFunc:THREE.AlwaysDepth}),o=new THREE.Geometry;o.vertices.push(new THREE.Vector3(0,0,0)),o.vertices.push(new THREE.Vector3(0,0,1e3));var s=new THREE.Line(o,a);s.renderOrder=5e4;var u=new THREE.LineBasicMaterial({color:4521796,depthFunc:THREE.AlwaysDepth}),l=new THREE.Geometry;l.vertices.push(new THREE.Vector3(0,0,0)),l.vertices.push(new THREE.Vector3(0,1e3,0));var c=new THREE.Line(l,u);c.renderOrder=5e4;var _=new THREE.LineBasicMaterial({linewidth:100,color:16729156,depthFunc:THREE.AlwaysDepth}),d=new THREE.Geometry;d.computeLineDistances(),d.vertices.push(new THREE.Vector3(0,0,0)),d.vertices.push(new THREE.Vector3(1e3,0,0));var f=new THREE.Line(d,_);return f.renderOrder=5e4,r.renderOrder=1e5,r.add(s),r.add(c),r.add(f),r.scale.set(e,e,e),r}return a(t,e),o(t,[{key:"update",value:function(){}},{key:"dispose",value:function(){}}]),t}(THREE.Object3D);e["default"]=s}),require.register("src/editor/shaders/object_picker_frag.glsl",function(e,t,r){r.exports="#define GLSLIFY 1\nuniform vec3 _Color;\n\nvoid main()\n{\n    gl_FragColor = vec4(_Color, 1.0);\n}"}),require.register("src/editor/shaders/object_picker_vert.glsl",function(e,t,r){r.exports="#define GLSLIFY 1\nvoid main()\n{\n  vec3 pos = position;\n  mat4 MVP = projectionMatrix * modelViewMatrix;\n\n  gl_Position = MVP * vec4( pos, 1.0 );\n  //gl_Position.zw -= 0.1;\n}"}),require.register("src/materials/BlitMaterial.js",function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var u=t("../shaders/copy/copy_vert"),l=n(u),c=t("../shaders/copy/copy_frag"),_=n(c),d=function(e){function t(e,r,n){var s;return a(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,(s={uniforms:{_MainTex:{value:null},_Resolution:{value:new THREE.Vector2(0,0)}},defines:n||{},vertexShader:r||l["default"],fragmentShader:e||_["default"],depthWrite:!1,blending:THREE.NoBlending,depthTest:!1},i(s,"depthWrite",!1),i(s,"depthFunc",THREE.AlwaysDepth),s)))}return s(t,e),t}(THREE.ShaderMaterial);e["default"]=d}),require.register("src/materials/ClearDepthNormalMaterial.js",function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var s=t("../materials/BlitMaterial"),u=n(s),l=t("../shaders/clear/clear_depth_normal_frag"),c=n(l),_=function(e){function t(e,r){i(this,t);var n=a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,c["default"]));return n.uniforms._DepthNormal={value:new THREE.Vector4(e,r.x,r.y,r.z)},n}return o(t,e),t}(u["default"]);e["default"]=_}),require.register("src/materials/DepthNormalMaterial.js",function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=t("../shaders/depth_normals/depth_normals_vert"),l=n(u),c=t("../shaders/depth_normals/depth_normals_frag"),_=n(c),d=function(e){function t(){return i(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{uniforms:{_FarPlane:{value:1}},vertexShader:l["default"],fragmentShader:_["default"]}))}return o(t,e),s(t,[{key:"far_plane",set:function(e){this.uniforms._FarPlane.value=e}}]),t}(THREE.ShaderMaterial);e["default"]=d}),require.register("src/primitives/Cube.js",function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var s=t("../Mesh"),u=n(s),l=function(e){function t(e,r,n){i(this,t),e=e||new THREE.Vector3(1,1,1),r=r||new THREE.Vector3(1,1,1),n=n||16711680;var o=new THREE.BoxGeometry(e.x,e.y,e.z,r.x,r.y,r.z),s=new THREE.MeshBasicMaterial({color:n});return a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,o,s))}return o(t,e),t}(u["default"]);e["default"]=l}),require.register("src/primitives/Sphere.js",function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(e,"__esModule",{value:!0});var o=function(e){function t(e,r){n(this,t),r=r||"#FF0000",e=e||1;var a=new THREE.SphereBufferGeometry(e,64,64),o=new THREE.MeshBasicMaterial({color:r});return i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,a,o))}return a(t,e),t}(THREE.Mesh);e["default"]=o}),require.register("src/render_mode/BaseRender.js",function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(){n(this,e)}return i(e,[{key:"render",value:function(){}},{key:"on_enter",value:function(e,t){}},{key:"on_exit",value:function(e,t){}},{key:"resize",value:function(){}}]),e}();e["default"]=a}),require.register("src/render_mode/OutlineRender.js",function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=t("../Screen"),s=n(o),u=t("../RenderLayers"),l=n(u),c=t("../shaders/box_blur/compose_frag"),_=n(c),d=t("../shaders/box_blur/box_blur_frag"),f=n(d),h=t("../shaders/copy/copy_frag"),p=n(h),v=t("../shaders/copy/copy_vert"),m=n(v),y=t("../shaders/basic_color/basic_color_frag"),g=n(y),b=function(){function e(t){i(this,e),this.main_rt=new THREE.WebGLRenderTarget(s["default"].width,s["default"].height),this.rt1=new THREE.WebGLRenderTarget(s["default"].width,s["default"].height),this.rt2=new THREE.WebGLRenderTarget(s["default"].width,s["default"].height),this.compose_material=this.__get_compose_material(),this.copy_material=this.__get_copy_material(),this.box_blur_material=this.__get_box_blur_material(),this.background_material=this.__get_background_material(),this.copy_plane=new THREE.Mesh(new THREE.PlaneGeometry(1,1),this.copy_material),this.copy_plane.frustumCulled=!1,this.copy_scene=new THREE.Scene,this.copy_scene.add(this.copy_plane)}return a(e,[{key:"resize",value:function(e,t){this.main_rt.setSize(e,t),this.rt1.setSize(e,t),this.rt2.setSize(e,t),this.box_blur_material.uniforms._Screen.value.set(e,t),this.compose_material.uniforms._Screen.value.set(e,t)}},{key:"render",value:function(e){e.camera.updateMatrix(),e.camera.updateMatrixWorld(),e.camera.layers.enable(l["default"].opaque),e.camera.layers.enable(l["default"].transparent),e.camera.layers.disable(l["default"].outline),e._renderer.setClearColor(e.clear_color,0),e._renderer.clearTarget(this.main_rt,!0,!0,!0),this.copy_scene.overrideMaterial=this.background_material,this.background_material.uniforms._Color.value.set(e.clear_color.r,e.clear_color.g,e.clear_color.b,0),e._renderer.render(this.copy_scene,e.camera,this.main_rt,!1),e._renderer.render(e.scene,e.camera,this.main_rt,!1),this.box_blur_material.uniforms._MainTex.value=this.main_rt.texture,this.box_blur_material.uniforms._SampleDir.value.set(1,0),this.copy_scene.overrideMaterial=this.box_blur_material,e._renderer.render(this.copy_scene,e.camera,this.rt1,!1),this.box_blur_material.uniforms._SampleDir.value.set(0,1),this.box_blur_material.uniforms._MainTex.value=this.rt1.texture,e._renderer.render(this.copy_scene,e.camera,this.rt2,!1),this.copy_scene.overrideMaterial=this.compose_material,this.compose_material.uniforms._MainTex.value=this.main_rt.texture,this.compose_material.uniforms._Blur.value=this.rt2.texture,e._renderer.render(this.copy_scene,e.camera,void 0,!1),this.copy_scene.overrideMaterial=void 0}},{key:"__get_copy_material",value:function(){return new THREE.ShaderMaterial({uniforms:{_MainTex:{value:void 0}},vertexShader:m["default"],fragmentShader:p["default"],depthTest:!1,depthWrite:!1})}},{key:"__get_box_blur_material",value:function(){return new THREE.ShaderMaterial({uniforms:{_MainTex:{value:void 0},_SampleDir:{value:new THREE.Vector2},_Screen:{value:new THREE.Vector2(s["default"].width,s["default"].height)}},vertexShader:m["default"],fragmentShader:f["default"],depthTest:!1,depthWrite:!1})}},{key:"__get_compose_material",value:function(){return new THREE.ShaderMaterial({uniforms:{_MainTex:{value:void 0},_Blur:{value:void 0},_Screen:{value:new THREE.Vector2(s["default"].width,s["default"].height)}},vertexShader:m["default"],fragmentShader:_["default"],depthTest:!1,depthWrite:!1,extensions:{derivatives:!0}})}},{key:"__get_background_material",value:function(){return new THREE.ShaderMaterial({uniforms:{_Color:{value:new THREE.Vector4(0,0,0,0)}},vertexShader:m["default"],fragmentShader:g["default"],depthTest:!0,depthWrite:!1})}},{key:"on_enter",value:function(e){e._renderer.autoClear=!1}},{key:"on_exit",value:function(e){e._renderer.autoClear=!0}}]),e}();e["default"]=b}),require.register("src/render_utilities/Blitter.js",function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=t("../materials/BlitMaterial"),s=n(o),u=function(){function e(t){i(this,e),this.renderer=t,this._blit_scene=new THREE.Scene,this._blit_material=new s["default"],this._blit_quad=new THREE.Mesh(new THREE.PlaneBufferGeometry(1,1),this._blit_material),this._blit_scene.add(this._blit_quad),this._blit_camera=new THREE.OrthographicCamera((-1),1,1,(-1),(-1e4),1e4)}return a(e,[{key:"blit",value:function(e,t){this._blit_quad.material=this._blit_material,this._blit_quad.material.uniforms._MainTex.value=e.texture,this._blit_quad.material.uniforms._Resolution.value.set(e.width,e.height),this.renderer.setRenderTarget(void 0===t?null:t),this.renderer.render(this._blit_scene,this._blit_camera)}},{key:"blit_with_material",value:function(e,t,r){this._blit_quad.material=r,this._blit_quad.material.uniforms._MainTex.value=e.texture,this._blit_quad.material.uniforms._Resolution.value.set(e.width,e.height),this.renderer.setRenderTarget(void 0===t?null:t),this.renderer.render(this._blit_scene,this._blit_camera)}},{key:"blit_clear_with_material",value:function(e,t){this._blit_quad.material=t,this.renderer.setRenderTarget(void 0===e?null:e),this.renderer.render(this._blit_scene,this._blit_camera)}}]),e}();e["default"]=u}),require.register("src/render_utilities/DepthAndNormalsRenderer.js",function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=t("../CameraManager"),s=n(o),u=t("../SceneManager"),l=(n(u),t("../Screen")),c=n(l),_=t("../materials/ClearDepthNormalMaterial"),d=n(_),f=t("../materials/DepthNormalMaterial"),h=n(f),p=function(){function e(){i(this,e),this.RT=new THREE.WebGLRenderTarget(c["default"].width,c["default"].height),this.clear_depth_normal_mat=new d["default"](1,new THREE.Vector3(0,0,1)),this.depth_normal_material=new h["default"]}return a(e,[{key:"render",value:function(e){this.__resize_RT_if_necessary(),e.clear(this.RT,void 0,!0,!0),e.blit_clear_with_material(this.RT,this.clear_depth_normal_mat),this.depth_normal_material.far_plane=s["default"].current.far,e.render(void 0,void 0,this.RT,this.depth_normal_material)}},{key:"__resize_RT_if_necessary",value:function(){this.RT.width===c["default"].width&&this.RT.height===c["default"].height||this.RT.setSize(c["default"].width,c["default"].height)}},{key:"render_target",get:function(){return this.RT}}]),e}();e["default"]=p}),require.register("src/shaders/basic_color/basic_color_frag.glsl",function(e,t,r){r.exports="#define GLSLIFY 1\nuniform vec3 _Color;\n\nvoid main()\n{\n    gl_FragColor = vec4(_Color, 1.0);\n}"}),require.register("src/shaders/basic_color/basic_color_vert.glsl",function(e,t,r){r.exports="#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main()\n{\n  vec3 pos = position;\n  mat4 MVP = projectionMatrix * modelViewMatrix;\n\n  gl_Position = MVP * vec4( pos, 1.0 );\n  vUv = uv;\n}"}),require.register("src/shaders/box_blur/box_blur_frag.glsl",function(e,t,r){r.exports="#define GLSLIFY 1\nuniform sampler2D _MainTex;\nuniform vec2 _Resolution;\nuniform vec2 _SampleDir;\nvarying vec2 vUv;\n\nvoid main()\n{\n\n\tvec3 sum = vec3(0.,0.,0.);\n\tvec2 dir = (0.5/_Resolution) * _SampleDir;\n\tfloat _Distance = 2.0;\n\tsum += texture2D( _MainTex, vUv + dir * -4. * _Distance ).rgb * 0.0525;\n\tsum += texture2D( _MainTex, vUv + dir * -3. * _Distance ).rgb * 0.075;\n\tsum += texture2D( _MainTex, vUv + dir * -2. * _Distance ).rgb * 0.110;\n\tsum += texture2D( _MainTex, vUv + dir * -1. * _Distance ).rgb * 0.150;\n\tsum += texture2D( _MainTex, vUv + dir *  0. * _Distance ).rgb * 0.225;\n\tsum += texture2D( _MainTex, vUv + dir *  1. * _Distance ).rgb * 0.150;\n\tsum += texture2D( _MainTex, vUv + dir *  2. * _Distance ).rgb * 0.110;\n\tsum += texture2D( _MainTex, vUv + dir *  3. * _Distance ).rgb * 0.075;\n\tsum += texture2D( _MainTex, vUv + dir *  4. * _Distance ).rgb * 0.0525;\n\tgl_FragColor = vec4(sum, 1.0);\n\n}\n"}),require.register("src/shaders/box_blur/compose_frag.glsl",function(e,t,r){r.exports="#define GLSLIFY 1\nuniform sampler2D _MainTex;\nuniform sampler2D _Blur;\nuniform vec2 _Screen;\nvarying vec2 vUv;\n\nfloat aastep(float threshold, float value) {\n  #ifdef GL_OES_standard_derivatives\n    float afwidth = length(vec2(dFdx(value), dFdy(value))) * 0.70710678118654757;\n    return smoothstep(threshold-afwidth, threshold+afwidth, value);\n  #else\n    return step(threshold, value);\n  #endif  \n}\n\nvoid main()\n{\n\tvec2 pixel_size = 1.0/_Screen;\n\n\tvec4 color = texture2D( _MainTex, vUv);\n\tfloat mask = 1.0 - color.a;\n\n\tfloat blur = texture2D( _Blur, vUv).a;\n\n  // gl_FragColor = vec4(mask,mask,mask,0.0);\n  // gl_FragColor = color;\n\n\tgl_FragColor = vec4(mix(color.rgb, mix(color.rgb, vec3(1.,0.,0.),aastep(0.076, blur)), mask), 1.0);\n}\n\n"}),require.register("src/shaders/clear/clear_depth_normal_frag.glsl",function(e,t,r){r.exports="#define GLSLIFY 1\nuniform vec4 _DepthNormal;\nvec2 EncodeFloatRG( float v )\n{\n    vec2 kEncodeMul = vec2(1.0, 255.0);\n    float kEncodeBit = 1.0/255.0;\n    vec2 enc = kEncodeMul * v;\n    enc = fract (enc);\n    enc.x -= enc.y * kEncodeBit;\n    return enc;\n}\n\nvec2 EncodeNormal (vec3 n)\n{\n    float scale = 1.7777;\n    vec2 enc = n.xy / (n.z+1.0);\n    enc /= scale;\n    enc = enc*0.5+0.5;\n    return enc;\n}\n\nvoid main()\n{\n    gl_FragColor = vec4(EncodeFloatRG(_DepthNormal.x), EncodeNormal(normalize(_DepthNormal.yzw)));  \n}"}),require.register("src/shaders/copy/copy_frag.glsl",function(e,t,r){r.exports="#define GLSLIFY 1\nuniform sampler2D _MainTex;\n\nvarying vec2 vUv;\nvoid main()\n{\n\tgl_FragColor = texture2D(_MainTex, vUv);\n}"}),require.register("src/shaders/copy/copy_vert.glsl",function(e,t,r){r.exports="#define GLSLIFY 1\nvarying vec2 vUv;\nvoid main()\n{\n\tgl_Position = vec4(uv * 2.0 - 1.0, 1.0, 1.0);\n\tvUv = uv;\n}"}),require.register("src/shaders/depth_normals/depth_normals_frag.glsl",function(e,t,r){r.exports="#define GLSLIFY 1\nvarying vec3 v_normal;\nvarying vec3 v_pos;\n\nuniform float _FarPlane;\n\nvec2 EncodeFloatRG( float v )\n{\n    vec2 kEncodeMul = vec2(1.0, 255.0);\n    float kEncodeBit = 1.0/255.0;\n    vec2 enc = kEncodeMul * v;\n    enc = fract (enc);\n    enc.x -= enc.y * kEncodeBit;\n    return enc;\n}\n\nvec2 EncodeNormal (vec3 n)\n{\n    float scale = 1.7777;\n    vec2 enc = n.xy / (n.z+1.0);\n    enc /= scale;\n    enc = enc*0.5+0.5;\n    return enc;\n}\n\nvoid main()\n{\n\tgl_FragColor = vec4(EncodeFloatRG(length(v_pos.z)/_FarPlane), EncodeNormal(normalize(v_normal)));\t\n}\n\n"}),require.register("src/shaders/depth_normals/depth_normals_vert.glsl",function(e,t,r){r.exports="#define GLSLIFY 1\nvarying vec3 v_normal;\nvarying vec3 v_pos;\n\nvoid main()\n{\n  vec3 pos = position;\n  mat4 MVP = projectionMatrix * modelViewMatrix;\n\n  v_normal \t= (modelViewMatrix * vec4(normal, 0.0)).xyz;\n  v_pos \t\t= (modelViewMatrix * vec4( pos, 1.0 )).xyz;\n\n  gl_Position = MVP * vec4( pos, 1.0 );\n}"}),require.register("src/static_batcher/GeometryBatch.js",function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function(){function e(t,r){n(this,e),this.geometry=t,this.material=void 0,this.uniforms={},this.batch_width=r,this.data_textures=[],this.object_names=void 0,this.zero_offset=new THREE.Vector2,this.write_offset=new THREE.Vector2,this.uniform_dirty_count=0,this.tmp_uploaded_data_count=0}return i(e,[{key:"init",value:function(e,t,r){this.material=new THREE.ShaderMaterial({uniforms:this.uniforms,vertexShader:t,fragmentShader:r}),this.object_names=e}},{key:"add_global_uniform",value:function(e,t){this.uniforms[e]={value:t},this.material.needsUpdate=!0}},{key:"set_global_uniform",value:function(e,t){this.uniforms[e].value=t}},{key:"add_object_uniform_v3",value:function(e,t){var r=this.__create_rgb_texture(this.batch_width),n=this.__create_rgb_texture(this.batch_width),i=this.__create_rgb_texture(1),a=this.__add_data_texture(e,r,n,i);t&&this.__flood_data_texture_rgb(a,t)}},{key:"add_object_uniform_v4",value:function(e,t){var r=this.__create_rgba_texture(this.batch_width),n=this.__create_rgba_texture(this.batch_width),i=this.__create_rgba_texture(1),a=this.__add_data_texture(e,r,n,i);t&&this.__flood_data_texture_rgba(a,t)}},{key:"add_object_uniform_v4_float",value:function(e,t){var r=this.__create_rgba_float_texture(this.batch_width),n=this.__create_rgba_float_texture(this.batch_width),i=this.__create_rgba_float_texture(1),a=this.__add_data_texture(e,r,n,i);t&&this.__flood_data_texture_rgba(a,t)}},{key:"set_object_uniform_v3",value:function(e,t,r,n,i,a){var o=this.__get_object_index(e),s=this.__get_data_texture(t);this.__set_pixel_rgb(s.src,o,r,n,i,a),this.__set_pixel_rgb(s.one_pixel,0,r,n,i,a),s.last_accessed_index=o,s.dirty_count++}},{key:"set_object_uniform_v4",value:function(e,t,r,n,i,a,o){var s=this.__get_object_index(e),u=this.__get_data_texture(t);this.__set_pixel_rgba(u.src,s,r,n,i,a,o),this.__set_pixel_rgba(u.one_pixel,0,r,n,i,a,o),u.last_accessed_index=s,u.dirty_count++}},{key:"upload_texture_data",value:function(e,t){for(var r=0;r<this.data_textures.length;r++)t>0&&this.data_textures[r].dirty_count>0&&(1===this.data_textures[r].dirty_count&&this.__partial_texture_data_upload(e,this.data_textures[r]),this.data_textures[r].dirty_count>1&&this.__full_texture_data_upload(e,this.data_textures[r]),this.data_textures[r].dirty_count=0,t--)}},{key:"get_uniform_dirty_count",value:function(){this.uniform_dirty_count=0;for(var e=0;e<this.data_textures.length;e++)this.data_textures[e].dirty_count>0&&this.uniform_dirty_count++;return this.uniform_dirty_count}},{key:"__full_texture_data_upload",value:function(e,t){t.dst.needsUpdate=!0,e.copyTextureToTexture(this.zero_offset,t.src,t.dst)}},{key:"__partial_texture_data_upload",value:function(e,t){var r=t.last_accessed_index;r!==-1&&(this.write_offset.y=Math.floor(r/this.batch_width),this.write_offset.x=r-this.batch_width*this.write_offset.y,e.copyTextureToTexture(this.write_offset,t.one_pixel,t.dst))}},{key:"get_mesh",value:function(){return new THREE.Mesh(this.geometry,this.material)}},{key:"__set_pixel_rgb",value:function(e,t,r,n,i,a){n&&(e.image.data[3*t+0]=r.x),i&&(e.image.data[3*t+1]=r.y),a&&(e.image.data[3*t+2]=r.z)}},{key:"__set_pixel_rgba",value:function(e,t,r,n,i,a,o){n&&(e.image.data[4*t+0]=r.x),i&&(e.image.data[4*t+1]=r.y),a&&(e.image.data[4*t+2]=r.z),o&&(e.image.data[4*t+3]=r.w)}},{key:"__flood_data_texture_rgb",value:function(e,t){for(var r=0;r<this.batch_width*this.batch_width;r++)this.__set_pixel_rgb(e.src,r,t,!0,!0,!0),e.dirty_count++}},{key:"__flood_data_texture_rgba",value:function(e,t){for(var r=0;r<this.batch_width*this.batch_width;r++)this.__set_pixel_rgba(e.src,r,t,!0,!0,!0,!0),e.dirty_count++}},{key:"__create_rgb_texture",value:function(e){var t=new Uint8Array(3*e*e);return new THREE.DataTexture(t,e,e,THREE.RGBFormat)}},{key:"__create_rgba_texture",value:function(e){var t=new Uint8Array(4*e*e);return new THREE.DataTexture(t,e,e,THREE.RGBAFormat)}},{key:"__create_rgba_float_texture",value:function(e){var t=new Float32Array(4*e*e);return new THREE.DataTexture(t,e,e,THREE.RGBA,THREE.FloatType)}},{key:"__get_data_texture",value:function(e){for(var t=0;t<this.data_textures.length;t++)if(this.data_textures[t].name===e)return this.data_textures[t];conosle.error("Data texture "+e+" does not exist")}},{key:"__get_object_index",value:function(e){for(var t=0;t<this.object_names.length;t++)if(this.object_names[t]===e)return t;console.error("the name "+e+" is not contained in this batch")}},{key:"__add_data_texture",value:function(e,t,r,n){return r.needsUpdate=!0,this.data_textures.push({name:e,src:t,dst:r,one_pixel:n,last_accessed_index:-1,dirty_count:0}),this.uniforms[e]={value:r},this.data_textures[this.data_textures.length-1]}},{key:"dispose",value:function(){for(var e=0;e<this.data_textures.length;e++)this.data_textures[e].src.dispose(),this.data_textures[e].dst.dispose(),this.data_textures[e].one_pixel.dispose()}}]),e}();e["default"]=a}),require.register("src/static_batcher/GeometryBatcher.js",function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=t("./GeometryBatch"),s=n(o),u=function(){function e(){i(this,e),this.batches=[]}return a(e,[{key:"batch",value:function(e){var t=[],r=THREE.Math.ceilPowerOfTwo(Math.sqrt(e.length));this.__init_uv_array(t,r);for(var n=0,i=0;i<e.length;i++)for(var a=e[i].getAttribute("position").count,o=Math.floor(i/r),u=i-r*o,l=0;l<a;l++)t[n]=u/r+.5/r,t[n+1]=o/r+.5/r,n+=2;var c=new THREE.BufferAttribute(new Float32Array(t),2),_=THREE.BufferGeometryUtils.mergeBufferGeometries(e);return _.addAttribute("attr_accessor_uv",c),this.batches.push(new s["default"](_,r)),this.batches[this.batches.length-1]}},{key:"upload_texture_data",value:function(e){for(var t=0;t<this.batches.length;t++)this.batches[t].upload_texture_data(e,1)}},{key:"__init_uv_array",value:function(e,t){for(var r=0;r<t*t*2;r++)e.push(0)}}]),e}(),l=new u;r.exports=l}),require.register("src/utilities/ModelUtilities.js",function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,
n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=e.ModelUtilities=function(){function e(){n(this,e)}return i(e,[{key:"get_mesh",value:function(e,t){e.traverse(function(e){e instanceof THREE.Mesh&&(e.geometry instanceof THREE.Geometry&&(e.geometry=(new THREE.BufferGeometry).fromGeometry(e.geometry)),t(e))})}},{key:"get_geometries",value:function(e){var t=[];return this.get_mesh(e,function(e){t.push(e.geometry)}),t}},{key:"assign_material",value:function(e,t,r){e.traverse(function(e){e instanceof THREE.Mesh&&(void 0===r?e.material=t:e.name===r&&(e.material=t))})}},{key:"set_shadow_config",value:function(e,t,r){e.traverse(function(e){e instanceof THREE.Mesh&&(e.castShadow=t,e.receiveShadow=r)})}},{key:"__find_object",value:function(e,t,r){e.traverse(function(e){e.name===t&&r(e)})}},{key:"get_object",value:function(e,t){var r=void 0;return e.traverse(function(e){e.name===t&&(r=e)}),r}},{key:"get_object_by_type",value:function(e,t){var r=void 0;return e.traverse(function(e){e.constructor.name===t&&(r=e)}),r}}]),e}(),o=new a;r.exports=o}),require.register("___globals___",function(e,t,r){})}(),require("___globals___");